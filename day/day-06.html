<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jour 6 ğŸ’• â€“ Puissance 4</title>
  <link href="../css/style.css" rel="stylesheet">
  <style>
    #board {
      display: grid;
      grid-template-columns: repeat(7, 50px);
      grid-gap: 5px;
      margin: 30px auto;
    }
    .cell {
      width: 50px;
      height: 50px;
      border-radius: 10px;
      background: #f7c1d9;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 30px;
      box-shadow: 0 3px 8px rgba(247,193,217,0.6);
      transition: transform 0.2s;
    }
    .cell:hover { transform: scale(1.05); }
    #message { text-align: center; margin-top: 20px; font-size: 18px; }
    #reset { display: block; margin: 15px auto; padding: 10px 25px; border-radius: 25px; background: #e8ddff; border: none; cursor: pointer; }
  </style>
</head>
<body>

<div class="home-container" id="day-content">
  <h1>ğŸ¾ Jour 6 â€“ Mini Puissance 4 ğŸ¾</h1>
  <p>Joue avec ğŸ’–, ou amuse-toi juste Ã  aligner les pions !</p>

  <div id="board"></div>
  <div id="message"></div>
  <button id="reset">Rejouer ğŸ’•</button>
</div>

<script src="../js/day.js"></script>
<script>
  checkDate(6);

  const boardEl = document.getElementById("board");
  const messageEl = document.getElementById("message");
  const resetBtn = document.getElementById("reset");

  const ROWS = 6, COLS = 7;
  let board = [];
  let gameOver = false;

  function initBoard() {
    board = Array.from({length: ROWS}, () => Array(COLS).fill(""));
    renderBoard();
    messageEl.innerText = "";
    gameOver = false;
  }

  function renderBoard() {
    boardEl.innerHTML = "";
    for(let r=0;r<ROWS;r++){
      for(let c=0;c<COLS;c++){
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.dataset.row = r;
        cell.dataset.col = c;
        cell.innerText = board[r][c];
        cell.addEventListener("click", () => handleClick(c));
        boardEl.appendChild(cell);
      }
    }
  }

  function handleClick(col){
    if(gameOver) return;

    // trouver la ligne vide la plus basse
    for(let r=ROWS-1;r>=0;r--){
      if(!board[r][col]){
        board[r][col]="ğŸ’–";
        renderBoard();
        if(checkWin("ğŸ’–")) { messageEl.innerText="Bravo ğŸ’• Tu as alignÃ© 4 pions !"; gameOver=true; return; }
        computerPlay();
        return;
      }
    }
  }

  function computerPlay(){
    if(gameOver) return;
    const available = [];
    for(let c=0;c<COLS;c++){
      if(!board[0][c]) available.push(c);
    }
    if(available.length===0) { gameOver=true; messageEl.innerText="Match nul ğŸ¤"; return; }
    const col = available[Math.floor(Math.random()*available.length)];
    for(let r=ROWS-1;r>=0;r--){
      if(!board[r][col]){
        board[r][col]="ğŸ¾";
        renderBoard();
        if(checkWin("ğŸ¾")) { messageEl.innerText="L'ordi a gagnÃ© ğŸ˜„ Rejoue !"; gameOver=true; return; }
        break;
      }
    }
  }

  function checkWin(player){
    // horizontal, vertical, diagonal
    for(let r=0;r<ROWS;r++){
      for(let c=0;c<COLS;c++){
        if(c+3<COLS && player===board[r][c] && player===board[r][c+1] && player===board[r][c+2] && player===board[r][c+3]) return true;
        if(r+3<ROWS && player===board[r][c] && player===board[r+1][c] && player===board[r+2][c] && player===board[r+3][c]) return true;
        if(r+3<ROWS && c+3<COLS && player===board[r][c] && player===board[r+1][c+1] && player===board[r+2][c+2] && player===board[r+3][c+3]) return true;
        if(r+3<ROWS && c-3>=0 && player===board[r][c] && player===board[r+1][c-1] && player===board[r+2][c-2] && player===board[r+3][c-3]) return true;
      }
    }
    return false;
  }

  resetBtn.addEventListener("click", initBoard);

  initBoard();
</script>

</body>
</html>
